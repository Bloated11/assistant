{% extends "base_.html" %}

{% block title %}Dashboard - PHENOM AI{% endblock %}

{% block content %}
<h1>COMMAND CENTER</h1>

<div class="glass-card">
    <h2>System Overview</h2>
    <div id="statsGrid"
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div
            style="padding: 1rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px;">
            <div style="font-size: 0.85rem; color: #b8d4e8; margin-bottom: 0.5rem;">Active Tasks</div>
            <div style="font-size: 2rem; color: #87CEEB;" id="taskCount">0</div>
        </div>
        <div
            style="padding: 1rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px;">
            <div style="font-size: 0.85rem; color: #b8d4e8; margin-bottom: 0.5rem;">Projects</div>
            <div style="font-size: 2rem; color: #87CEEB;" id="projectCount">0</div>
        </div>
        <div
            style="padding: 1rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px;">
            <div style="font-size: 0.85rem; color: #b8d4e8; margin-bottom: 0.5rem;">Goals</div>
            <div style="font-size: 2rem; color: #87CEEB;" id="goalCount">0</div>
        </div>
        <div
            style="padding: 1rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px;">
            <div style="font-size: 0.85rem; color: #b8d4e8; margin-bottom: 0.5rem;">Habits Tracked</div>
            <div style="font-size: 2rem; color: #87CEEB;">0</div>
        </div>
    </div>
</div>

<div class="glass-card">
    <h2>Quick Access</h2>
    <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <a href="/ai"
            style="padding: 1.5rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px; text-decoration: none; color: #87CEEB; text-align: center; transition: all 0.3s;"
            onmouseover="this.style.background=\'rgba(135, 206, 250, 0.15)\'"
            onmouseout="this.style.background=\'rgba(135, 206, 250, 0.05)\'">
            <i class="fas fa-brain" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
            AI Assistant
        </a>
        <a href="/tasks"
            style="padding: 1.5rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px; text-decoration: none; color: #87CEEB; text-align: center; transition: all 0.3s;"
            onmouseover="this.style.background=\'rgba(135, 206, 250, 0.15)\'"
            onmouseout="this.style.background=\'rgba(135, 206, 250, 0.05)\'">
            <i class="fas fa-tasks" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
            Tasks
        </a>
        <a href="/projects"
            style="padding: 1.5rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px; text-decoration: none; color: #87CEEB; text-align: center; transition: all 0.3s;"
            onmouseover="this.style.background=\'rgba(135, 206, 250, 0.15)\'"
            onmouseout="this.style.background=\'rgba(135, 206, 250, 0.05)\'">
            <i class="fas fa-project-diagram" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
            Projects
        </a>
        <a href="/notes"
            style="padding: 1.5rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px; text-decoration: none; color: #87CEEB; text-align: center; transition: all 0.3s;"
            onmouseover="this.style.background=\'rgba(135, 206, 250, 0.15)\'"
            onmouseout="this.style.background=\'rgba(135, 206, 250, 0.05)\'">
            <i class="fas fa-sticky-note" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
            Notes
        </a>
        <a href="/system/status"
            style="padding: 1.5rem; background: rgba(135, 206, 250, 0.05); border: 1px solid rgba(135, 206, 250, 0.2); border-radius: 4px; text-decoration: none; color: #87CEEB; text-align: center; transition: all 0.3s;"
            onmouseover="this.style.background=\'rgba(135, 206, 250, 0.15)\'"
            onmouseout="this.style.background=\'rgba(135, 206, 250, 0.05)\'">
            <i class="fas fa-server" style="font-size: 2rem; display: block; margin-bottom: 0.5rem;"></i>
            System Status
        </a>
    </div>
</div>

<div class="glass-card">
    <h2>Recent Activity</h2>
    <div style="padding: 2rem; text-align: center; color: #b8d4e8;">
        No recent activity
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    async function loadStats() {
        try {
            const [tasksRes, projectsRes, goalsRes] = await Promise.all([
                fetch('/tasks/api/all', { credentials: 'include' }),
                fetch('/projects/api/all', { credentials: 'include' }),
                fetch('/goals/api/all', { credentials: 'include' })
            ]);

            const tasks = await tasksRes.json();
            const projects = await projectsRes.json();
            const goals = await goalsRes.json();

            const pendingTasks = tasks.filter(t => !t.completed).length;
            const projectCount = Object.keys(projects.projects || {}).length;
            const goalCount = Object.keys(goals.goals || {}).length;

            document.getElementById('taskCount').textContent = pendingTasks;
            document.getElementById('projectCount').textContent = projectCount;
            document.getElementById('goalCount').textContent = goalCount;
        } catch (e) {
            console.error('Error loading stats:', e);
        }
    }

    window.addEventListener('load', function () {
        if (typeof setHologramMode === 'function') {
            setHologramMode('idle');
        }
        loadStats();
        setInterval(loadStats, 5000);
    });
</script>
{% endblock %}